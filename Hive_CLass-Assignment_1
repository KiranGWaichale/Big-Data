# copy file from local to hdfs location

[cloudera@quickstart ~]$ hadoop fs -mkdir /tmp/hive_class/
[cloudera@quickstart ~]$ hadoop fs -ls /tmp/hive_class/
[cloudera@quickstart ~]$ hadoop fs -put /tmp/hive_class/sales_order_data.csv /tmp/hive_class/
[cloudera@quickstart ~]$ hadoop fs -ls /tmp/hive_class/
Found 1 items
-rw-r--r--   1 cloudera supergroup     360233 2022-09-12 09:50 /tmp/hive_class/sales_order_data.csv


# sales_order_csv table creation

hive> create table sales_order_csv
    > (
    > ORDERNUMBER int,
    > QUANTITYORDERED int,
    > PRICEEACH float,
    > ORDERLINENUMBER int,
    > SALES float,
    > STATUS string,
    > QTR_ID int,
    > MONTH_ID int,
    > YEAR_ID int,
    > PRODUCTLINE string,
    > MSRP int,
    > PRODUCTCODE string,
    > PHONE string,
    > CITY string,
    > STATE string,
    > POSTALCODE string,
    > COUNTRY string,
    > TERRITORY string,
    > CONTACTLASTNAME string,
    > CONTACTFIRSTNAME string,
    > DEALSIZE string
    > )
    > row format delimited
    > fields terminated by ','
    > tblproperties("skip.header.line.count"="1");
OK
Time taken: 26.13 seconds



# describe table sales_order_csv

hive> describe formatted sales_order_csv;


# load data from hdfs location

hive> load data inpath '/tmp/hive_class/sales_order_data.csv' into table sales_order_csv;
Loading data to table hive_class_b1.sales_order_csv
Table hive_class_b1.sales_order_csv stats: [numFiles=1, totalSize=360233]
OK
Time taken: 2.609 seconds



# create table sales_order_orc

hive> create table sales_order_orc
    > (
    > ORDERNUMBER int,
    > QUANTITYORDERED int,
    > PRICEEACH float,
    > ORDERLINENUMBER int,
    > SALES float,
    > STATUS string,
    > QTR_ID int,
    > MONTH_ID int,
    > YEAR_ID int,
    > PRODUCTLINE string,
    > MSRP int,
    > PRODUCTCODE string,
    > PHONE string,
    > CITY string,
    > STATE string,
    > POSTALCODE string,
    > COUNTRY string,
    > TERRITORY string,
    > CONTACTLASTNAME string,
    > CONTACTFIRSTNAME string,
    > DEALSIZE string
    > )
    > stored as orc;
OK
Time taken: 1.944 seconds



# Load data from "sales_order_csv" into "sales_order_orc"

hive> from sales_order_csv insert overwrite table sales_order_orc select *;
